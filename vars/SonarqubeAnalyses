def call(Map config) {
    def sonarCredentialsId = config.sonarCredentialsId
    def sonarServer = config.sonarServer

    script {
        withCredentials([string(credentialsId: sonarCredentialsId, variable: 'SONAR_SECRET')]) {
            sh "sonar-scanner -Dsonar.host.url=https://${sonarServer} -Dsonar.login=\${SONAR_SECRET}"
        }
    }
}
